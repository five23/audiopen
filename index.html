<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>audiopen.js</title>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
	<link rel="stylesheet" href="https://netdna.bootstrapcdn.com/font-awesome/3.1.1/css/font-awesome.css">
	<link rel="stylesheet" href="css/styles.css">
</head>
<body>
	<div id="gui">
		<div class="button-group-navigation">
			<li>
				<a class="btn" href="#" id="play">
					<i class="icon-play"></i>
				</a>
			</li>
			<li>
				<a class="btn" href="#" id="stop">
					<i class="icon-stop"></i>
				</a>
			</li>
		</div>
		<canvas id="waveform" width="443px" height="240px"></canvas>	
		<canvas id="vca" nx="position" width="450px" height="150px"></canvas>
		<canvas id="vcb" nx="position" width="450px" height="150px"></canvas>
		<canvas id="vcc" nx="position" width="450px" height="150px"></canvas>
		<canvas id="vcd" nx="position" width="450px" height="150px"></canvas>
	</div>
	<div id="editor">
var omega = 220 * 2 * Math.PI / 44100;
var pA = 0.15915494309189533576888376337251;
var amplitude = .5;
var z1 = .998;

vca.theta = 0, vca.t = 0, vca.n = 0;
vcb.theta = 0, vcb.t = 0, vcb.n = 0;
vcc.theta = 0, vcc.t = 0, vcc.n = 0;
vcd.theta = 0, vcd.t = 0, vcd.n = 0;

function process(a) {
    
  for (var k = 0; k < a.length; ++k) {
      
    vca.n = lowpass(vca.val.y * 10, vca.n, z1);
    vcb.n = lowpass(vcb.val.y * 10, vcb.n, z1);
    vcc.n = lowpass(vcc.val.y * 10, vcc.n, z1);
    vcd.n = lowpass(vcd.val.y * 10, vcd.n, z1);
    
    vca.theta += vca.t = lowpass(vca.val.x * omega, vca.t, z1);
    vcb.theta += vcb.t = lowpass(vcb.val.x * omega, vcb.t, z1);
    vcc.theta += vcc.t = lowpass(vcc.val.x * omega, vcc.t, z1);
    vcd.theta += vcd.t = lowpass(vcd.val.x * omega, vcd.t, z1);
    
    a[k] = amplitude * 0.25 * (
        square(vca.theta, vca.n) + 
        square(vcb.theta, vcb.n) + 
        square(vcc.theta, vcc.n) + 
        square(vcd.theta, vcd.n)
    );
  }
  
  return a;
}

function square(x, m) {
    var b = 0;
    var a = m * Math.cos(x);
    var f = Math.cos(2 * Math.PI * a);
    
    while (16 > a) {
        b += pA / (.1875 + a*a + a++);
    }
    
    return f*b-1;
}

function lowpass(x, n, z) {
    return x + (n - x) * z;
}</div>
</body>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.3/ace.js"></script>
	<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
	<script type="text/javascript" src="js/kmath.js" type="text/javascript"></script>
    <script type="text/javascript" src="js/nexusUI.js" type="text/javascript"></script>
	<script type="text/javascript" src="js/audiopen.js" type="text/javascript"></script>
</html>
